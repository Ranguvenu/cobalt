define ("mod_stream/stream",["jquery","media_videojs/video-lazy","mod_stream/jquery.dataTables","mod_stream/flatpickr","mod_stream/radioslider","core/modal_factory","core/modal_events","core/fragment","core/templates","core/ajax","core/str"],function(a,b,c,d,e,f,g,h,i,j,k){var l=[];return{init:function init(){var b=this;a(".dataTable").each(function(){viewDatatble=b.DataTables(this.id)});a(document).on("graphsReload","#segmented-button",function(){a(".dataTable").each(function(){console.log(this);var c=b.DataTables(this.id),d=a(this).data("timestamps");l[a(this).attr("id")].columns(0).search(d).draw()})});d("#customrange",{mode:"range",onClose:function onClose(b){var c=b[1].getTime()/1e3+86400,d=b[0].getTime()/1e3+"-"+c;a("#segmented-button").data("timestamps",d);a("#segmented-button").trigger("graphsReload")}});e.init(a("#segmented-button"),{size:"medium",animation:!0});a(document).on("radiochange","#segmented-button",function(){var b=a("#segmented-button").find("input:checked").attr("value"),c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate()),e="";a("#customrange").hide();var f=!0;switch(b){case"week":e=new Date(c.getFullYear(),c.getMonth(),c.getDate()-7);break;case"month":e=new Date(c.getFullYear(),c.getMonth()-1,c.getDate());break;case"year":e=new Date(c.getFullYear()-1,c.getMonth(),c.getDate());break;case"custom":a("#customrange").show();return;break;case"clear":f=!1;break;default:break;}if(f){var g=e.getTime()/1e3+"-"+d.getTime()/1e3}else{var g="0-0"}viewDatatble.columns(0).search(g).draw();a("#segmented-button").data("timestamps",g);a("#segmented-button").trigger("graphsReload")});a(document).on("change","#module_select_filter",function(){var b=a("#course_select_filter").children("option:selected").val();window.location.href=M.cfg.wwwroot+"/mod/stream/"+a(this).children("option:selected").data("page")+"?id="+b+"&cmid="+a(this).children("option:selected").val()});a(document).on("change","#course_select_filter",function(){window.location.href=M.cfg.wwwroot+"/mod/stream/"+a(this).children("option:selected").data("page")+"?id="+a(this).children("option:selected").val()})},DataTables:function DataTables(b){var c=a("#"+b).data("function"),d=a("#"+b).data("id"),e=a("#"+b).data("type"),f=a("#"+b).data("pagelength");if(f==void 0){f=10}var g={action:c,id:d,type:e};console.log(b);return l[b]=a("#"+b).DataTable({bInfo:!1,bLengthChange:!1,language:{paginate:{next:">",previous:"<"}},pageLength:f,processing:!0,serverSide:!0,retrieve:!0,ajax:{type:"POST",dataType:"json",url:M.cfg.wwwroot+"/lib/ajax/service.php?sesskey="+M.cfg.sesskey+"&info=mod_stream_tablecontent",data:function data(b){newdata={};newdata.methodname="mod_stream_tablecontent";g.timestamps=a("#segmented-button").data("timestamps");newdata.args={args:JSON.stringify({d:b,args:g})};return JSON.stringify([newdata])},dataSrc:function dataSrc(a){var b=JSON.parse(a[0].data.data);return b}}}).on("draw.dt",function(){if("getSummaryReport"==c){a(".rating-1").each(function(){for(var b=a(this).data("stars"),c=1,d;5>=c;c++){d=a("<i>",{class:"fa fa-star",style:"font-size: 16px; margin-left: 1px; color:"+(c<=b?"#f1c40f":"#ecf0f1")});a(this).append(d)}})}})},DrillDownReportPopup:function DrillDownReportPopup(){a(document).on("click",".drilldownreportpopup",function(){var b=a(this).data(),c=a(this).data("function")+"table"+a(this).data("id"),d=a("#segmented-button").data("timestamps");if(d!=void 0){b.timestamps=d}if(b.email!=void 0){var e=b.reportname+"("+b.email+")"}else{var e=b.reportname}var i=h.loadFragment("mod_stream","drilldownreport",1,b);return k.get_strings([{key:"tablesearch",component:"stream"}]).then(function(d){f.create({title:e,type:f.types.DEFAULT,body:i}).done(function(e){this.modal=e;this.modal.getRoot().addClass("drilldown"+b.function);this.modal.setLarge();e.show();this.modal.getRoot().on(g.bodyRendered,function(){a("#"+c).DataTable({destroy:!0,language:{search:"<i class=\"fa fa-search\"></i>",searchPlaceholder:d[0],paginate:{previous:"<i class=\"fa fa-angle-left\"></i>",next:"<i class=\"fa fa-angle-right\"></i>"}},bInfo:!1,pageLength:10})}.bind(this))}.bind(this))})})}}});
//# sourceMappingURL=stream.min.js.map
