{"version":3,"sources":["../src/deletevideo.js"],"names":["define","$","Str","ModalFactory","ModalEvents","Ajax","init","on","dataid","data","get_strings","key","component","then","s","create","title","type","types","SAVE_CANCEL","body","done","modal","setSaveButtonText","getRoot","save","e","preventDefault","promise","call","methodname","args","id","contextid","hide","window","location","reload","fail","ex","console","log","bind","show"],"mappings":"AAAAA,OAAM,4BAAC,CAAC,QAAD,CAAW,UAAX,CAAuB,oBAAvB,CAA6C,mBAA7C,CAAmE,WAAnE,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAiBC,CAAjB,CAA+BC,CAA/B,CAA4CC,CAA5C,CAAkD,CAE9C,MAAO,CACHC,IAAI,CAAE,eAAU,CACZL,CAAC,0CAAD,CAAYM,EAAZ,CAAe,OAAf,CAAwB,UAAU,CAC9B,GAAIC,CAAAA,CAAM,CAAGP,CAAC,CAAC,IAAD,CAAD,CAAQQ,IAAR,CAAa,IAAb,CAAb,CACA,MAAOP,CAAAA,CAAG,CAACQ,WAAJ,CAAgB,CAAC,CACpBC,GAAG,CAAE,aADe,CAEpBC,SAAS,CAAE,cAFS,CAAD,CAIvB,CACID,GAAG,CAAE,eADT,CAEIC,SAAS,CAAE,cAFf,CAJuB,CAQvB,CACID,GAAG,CAAE,SADT,CARuB,CAAhB,EAWJE,IAXI,CAWC,SAASC,CAAT,CAAY,CAChBX,CAAY,CAACY,MAAb,CAAoB,CAChBC,KAAK,CAAEF,CAAC,CAAC,CAAD,CADQ,CAEhBG,IAAI,CAAEd,CAAY,CAACe,KAAb,CAAmBC,WAFT,CAGhBC,IAAI,CAAEN,CAAC,CAAC,CAAD,CAHS,CAApB,EAIGO,IAJH,CAIQ,SAASC,CAAT,CAAgB,CACpB,KAAKA,KAAL,CAAaA,CAAb,CACAA,CAAK,CAACC,iBAAN,CAAwBT,CAAC,CAAC,CAAD,CAAzB,EACAQ,CAAK,CAACE,OAAN,GAAgBjB,EAAhB,CAAmBH,CAAW,CAACqB,IAA/B,CAAqC,SAASC,CAAT,CAAY,CAC7CA,CAAC,CAACC,cAAF,GAD6C,GAMzCC,CAAAA,CAAO,CAAGvB,CAAI,CAACwB,IAAL,CAAU,CAAC,CACrBC,UAAU,CAAE,2BADS,CAErBC,IAAI,CANK,CACNC,EADM,CACDxB,CADC,CAENyB,SAFM,CAEM,CAFN,CAIY,CAAD,CAAV,CAN+B,CAU7CL,CAAO,CAAC,CAAD,CAAP,CAAWP,IAAX,CAAgB,UAAe,CAC3BC,CAAK,CAACY,IAAN,GACAC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,EACH,CAHD,EAGGC,IAHH,CAGQ,SAASC,CAAT,CAAa,CAEhBC,OAAO,CAACC,GAAR,CAAYF,CAAZ,CACJ,CAND,CAOH,CAjBoC,CAiBnCG,IAjBmC,CAiB9B,IAjB8B,CAArC,EAkBApB,CAAK,CAACqB,IAAN,EACH,CAtBO,CAsBND,IAtBM,CAsBD,IAtBC,CAJR,CA2BH,CA5BO,CA4BNA,IA5BM,CA4BD,IA5BC,CAXD,CAwCV,CA1CD,CA2CH,CA7CE,CA+Cd,CAlDK,CAAN","sourcesContent":["define(['jquery', 'core/str', 'core/modal_factory', 'core/modal_events',  'core/ajax'],\n    function($, Str, ModalFactory, ModalEvents, Ajax) {\n        var SELECTOR = \"a[data-action='deletevideo-favourite']\";\n        return {\n            init: function(){\n                $(SELECTOR).on('click', function(){\n                    var dataid = $(this).data('id');\n                    return Str.get_strings([{\n                        key: 'deletevideo',\n                        component: 'block_stream'\n                    },\n                    {\n                        key: 'deleteconfirm',\n                        component: 'block_stream'\n                    },\n                    {\n                        key: 'confirm'\n                    }\n                    ]).then(function(s) {\n                        ModalFactory.create({\n                            title: s[0],\n                            type: ModalFactory.types.SAVE_CANCEL,\n                            body: s[1]\n                        }).done(function(modal) {\n                            this.modal = modal;\n                            modal.setSaveButtonText(s[2]);\n                            modal.getRoot().on(ModalEvents.save, function(e) {\n                                e.preventDefault();\n                                var params = {};\n                                params.id = dataid;\n                                params.contextid = 1;\n\n                                var promise = Ajax.call([{\n                                    methodname: 'block_stream_delete_video',\n                                    args: params\n                                }]);\n                                promise[0].done(function(resp) {\n                                    modal.hide();\n                                    window.location.reload();\n                                }).fail(function(ex) {\n                                    // do something with the exception\n                                     console.log(ex);\n                                });\n                            }.bind(this));\n                            modal.show();\n                        }.bind(this));\n                    }.bind(this));\n                });\n            }\n        }\n});"],"file":"deletevideo.min.js"}